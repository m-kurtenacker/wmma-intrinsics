fn @get_accelerator () {
    amdgpu_hsa_accelerator(1)
}

fn @accelerated_matmul (hsa : Accelerator, a : Tensor[f16], b : Tensor[f16], c : Tensor[f16], d : Tensor[f16]) -> () {
    matrix_multiply_acc_simple [amdgcn_mat_datatype, amdgcn_mat_datatype, amdgcn_acc_datatype] (hsa, a, b, c, d);
}

fn @ref_matmul (a : Tensor[f16], b : Tensor[f16], c : Tensor[f16], d : Tensor[f16]) -> () {
    matrix_multiply_naive(a, b, c, d);
}
